{"version":3,"sources":["lineGraph.js"],"names":["margin","top","right","bottom","left","width","height","x","d3","scaleLinear","range","y","races","colors","valueline","intent","line","d","Age","HomicideCnt","SuicideCnt","getFilteredData","data","race","filter","Race","svg","select","append","attr","csvFile","require","csv","then","domain","max","i","length","filteredData","call","axisBottom","axisLeft","addLegend","addMouseOver","legend","selectAll","enter","text","style","mouseG","lines","document","getElementsByClassName","mousePerLine","on","mouse","xAge","invert","bisect","bisector","beginning","end","getTotalLength","target","Math","floor","pos","getPointAtLength","toFixed"],"mappings":"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","file":"lineGraph.98da0954.js","sourceRoot":"../src","sourcesContent":["// set the dimensions and margins of the graph\nvar margin = {top: 20, right: 20, bottom: 30, left: 50},\n    width = 960 - margin.left - margin.right,\n    height = 500 - margin.top - margin.bottom;\n\n// set the ranges\nvar x = d3.scaleLinear().range([0, width]);\nvar y = d3.scaleLinear().range([height, 0]);\n\nvar races = [\"Asian/Pacific Islander\", \"Black\", \"Hispanic\", \"Native American\", \"White\"];\nvar colors = [\"#A6ACAF\", \"#52BE80\", \"#5DADE2\", \"#E74C3C\", \"#2471A3\", \"#E67E22\"];\n\n// define the line\nfunction valueline(intent) {\n  return d3.line()\n        .x(function(d) { return x(d.Age); })\n        .y(function(d) { if (intent == 1) {\n                          return y(d.HomicideCnt + d.SuicideCnt);\n                        } else if (intent == 2) {\n                          return y(d.HomicideCnt);\n                        } else {\n                          return y(d.SuicideCnt);\n                        } });\n}\n\nfunction getFilteredData(data, race) {\n  return data.filter(function(d) { return d.Race === race });\n}\n\n\n// append the svg obgect to the body of the page\n// appends a 'group' element to 'svg'\n// moves the 'group' element to the top left margin\nvar svg = d3.select(\"body\").append(\"svg\")\n    .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + margin.bottom)\n  .append(\"g\")\n    .attr(\"transform\",\n          \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n// Get the data\nconst csvFile = require(\"./lineGraphData.csv\");\nd3.csv(csvFile, function(d) {\n    // format the data\n    d.Age = +d.Age;\n    d.HomicideCnt = +d.HomicideCnt;\n    d.SuicideCnt = +d.SuicideCnt;\n    return d;\n  }).then(function(data){\n    // Scale the range of the data\n    x.domain([0, d3.max(data, function(d) { return d.Age; })]);\n    y.domain([0, 1500]).range([height, 10]);\n    //y.domain([0, getMaxValue(data)]).range([height, 10]);\n\n    // Add the valueline path.\n    for (let i = 0; i < races.length; i++) {\n      var filteredData = getFilteredData(data, races[i]);\n      svg.append(\"path\")\n          .attr(\"class\", \"line\")\n          .data([filteredData])\n          .attr(\"stroke\", colors[i])\n          .attr(\"d\", valueline(1));\n    }\n\n    // Add the X Axis\n    svg.append(\"g\")\n        .attr(\"transform\", \"translate(0,\" + height + \")\")\n        .call(d3.axisBottom(x));\n\n    // Add the Y Axis\n    svg.append(\"g\")\n        .call(d3.axisLeft(y));\n\n    addLegend();\n\n    addMouseOver();\n\n  })\n\n  function addLegend() {\n    var legend = svg.selectAll(\".legend\")\n        .data(races)\n        .enter()\n        .append(\"g\")\n        .attr(\"transform\", function(d, i){\n            return \"translate(\" + (width-100) + \",\" + (i*15 +20) + \")\";\n        })\n        .attr(\"class\", \"legend\");\n\n    legend.append(\"rect\")\n        .attr(\"width\", 10)\n        .attr(\"height\", 10)\n        .attr(\"fill\", function(d, i){\n            return colors[i];\n        });\n\n    legend.append(\"text\")\n        .text(function(d, i){\n            return races[i];\n        })\n        .style(\"font-size\", 12)\n        .attr(\"y\", 10)\n        .attr(\"x\", 11);\n  }\n\n  function addMouseOver() {\n    var mouseG = svg.append(\"g\")\n      .attr(\"class\", \"mouse-over-effects\");\n\n      mouseG.append(\"path\") // this is the black vertical line to follow mouse\n        .attr(\"class\", \"mouse-line\");\n\n  var lines = document.getElementsByClassName('line');\n\n  var mousePerLine = mouseG.selectAll('.mouse-per-line')\n    .data(races)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"mouse-per-line\");\n\n  mousePerLine.append(\"circle\")\n    .attr(\"r\", 5)\n    .style(\"stroke\", \"black\")\n    .style(\"fill\", function(d, i){\n        return colors[i];\n    })\n    .style(\"stroke-width\", \"1px\")\n    .style(\"opacity\", \"0\");\n\n  mousePerLine.append(\"text\")\n    .attr(\"transform\", \"translate(10,3)\");\n\n  mouseG.append('svg:rect') // append a rect to catch mouse movements on canvas\n    .attr('width', width) // can't catch mouse events on a g element\n    .attr('height', height)\n    .attr('fill', 'none')\n    .attr('pointer-events', 'all')\n    .on('mouseout', function() { // on mouse out hide line, circles and text\n      d3.select(\".mouse-line\")\n        .style(\"opacity\", \"0\");\n      d3.selectAll(\".mouse-per-line circle\")\n        .style(\"opacity\", \"0\");\n      d3.selectAll(\".mouse-per-line text\")\n        .style(\"opacity\", \"0\");\n    })\n    .on('mouseover', function() { // on mouse in show line, circles and text\n      d3.select(\".mouse-line\")\n        .style(\"opacity\", \"1\");\n      d3.selectAll(\".mouse-per-line circle\")\n        .style(\"opacity\", \"1\");\n      d3.selectAll(\".mouse-per-line text\")\n        .style(\"opacity\", \"1\");\n    })\n    .on('mousemove', function() { // mouse moving over canvas\n      var mouse = d3.mouse(this);\n      d3.select(\".mouse-line\")\n        .attr(\"d\", function() {\n          var d = \"M\" + mouse[0] + \",\" + height;\n          d += \" \" + mouse[0] + \",\" + 0;\n          return d;\n        });\n\n      d3.selectAll(\".mouse-per-line\")\n        .attr(\"transform\", function(d, i) {\n          //console.log(width/mouse[0])\n          var xAge = x.invert(mouse[0]),\n              bisect = d3.bisector(function(d) { return d.Age; }).right;\n              //idx = bisect(d.values, xAge);\n\n          var beginning = 0,\n              end = lines[i].getTotalLength(),\n              target = null;\n\n          while (true){\n            target = Math.floor((beginning + end) / 2);\n            pos = lines[i].getPointAtLength(target);\n            if ((target === end || target === beginning) && pos.x !== mouse[0]) {\n                break;\n            }\n            if (pos.x > mouse[0])      end = target;\n            else if (pos.x < mouse[0]) beginning = target;\n            else break; //position found\n          }\n\n          d3.select(this).select('text')\n            .text(y.invert(pos.y).toFixed(0));\n\n          return \"translate(\" + mouse[0] + \",\" + pos.y +\")\";\n        });\n    });\n  }\n"]}